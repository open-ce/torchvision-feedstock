tests:
  - name: Setup TorchVision Tests
    command: |
        conda install -y git
        git clone -b v$(python -c "import torchvision; print(torchvision.__version__)") https://github.com/pytorch/vision.git
        cd vision
        rm -rf torchvision
        conda install -y pytest pytest-mock
  - name: Run TorchVision tests
    command: |
        cd vision
        SKIPPED_TESTS=(
                     "not test_fasterrcnn_double and"
                     "not test_detection_model and"
                     "not test_qroialign and"
                     "not test_random_rotate and"
                     "not test_masks_box and"
                     "not test_classification_model and"
                     "not test_url_is_accessible"

        )
        pytest -k "${SKIPPED_TESTS[*]}" -v test/
  - name: Clean tests
    command: rm -rf vision
